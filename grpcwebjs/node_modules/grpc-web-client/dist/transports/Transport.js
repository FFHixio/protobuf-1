"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var fetch_1 = require("./fetch");
var xhr_1 = require("./xhr");
var msStream_1 = require("./msStream");
var xhr;
function getXHR() {
    if (xhr !== undefined)
        return xhr;
    if (XMLHttpRequest) {
        xhr = new XMLHttpRequest();
        try {
            xhr.open('GET', 'https://localhost');
        }
        catch (e) { }
    }
    return xhr;
}
function xhrSupportsResponseType(type) {
    var xhr = getXHR();
    if (!xhr) {
        return false;
    }
    try {
        xhr.responseType = type;
        return xhr.responseType === type;
    }
    catch (e) { }
    return false;
}
var DefaultTransportFactory = (function () {
    function DefaultTransportFactory() {
    }
    DefaultTransportFactory.getTransport = function () {
        if (!this.selected) {
            this.selected = DefaultTransportFactory.detectTransport();
        }
        return this.selected;
    };
    DefaultTransportFactory.detectTransport = function () {
        if (typeof Response !== "undefined" && Response.prototype.hasOwnProperty("body") && typeof Headers === "function") {
            return fetch_1.default;
        }
        if (xhrSupportsResponseType("ms-stream")) {
            return msStream_1.default;
        }
        return xhr_1.default;
    };
    return DefaultTransportFactory;
}());
exports.DefaultTransportFactory = DefaultTransportFactory;
//# sourceMappingURL=Transport.js.map